<!doctype html>
<html lang="ru">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bulk Sender Ultimate v6.2</title>
  <link rel="icon" type="image/png" href="velik.png">

  <style>
    :root {
      /* LIGHT (default) */
      --bg: #e9eef6;
      --card: #ffffff;
      --muted: #475569;
      --ok: #15803d;
      --err: #dc2626;
      --info: #0284c7;
      --ink: #0b1220;
      --border: #cbd5e1;
      --soft: #eef2f7;
      --blue: #1d4ed8;

      --shadow: 0 10px 28px rgba(2, 6, 23, 0.10);
      --shadow-soft: 0 6px 18px rgba(2, 6, 23, 0.08);
      --ring: 0 0 0 4px rgba(29, 78, 216, 0.16);
    }

    /* DARK */
    html[data-theme="dark"] {
      --bg: #0b1220;
      /* –æ–±—â–∏–π —Ñ–æ–Ω */
      --card: #0f172a;
      /* –∫–∞—Ä—Ç–æ—á–∫–∏ */
      --soft: #0b1324;
      /* ‚Äúsoft‚Äù –±–ª–æ–∫–∏ */
      --ink: #e5e7eb;
      /* –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç */
      --muted: #94a3b8;
      /* –≤—Ç–æ—Ä–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç */
      --border: #263244;
      /* –≥—Ä–∞–Ω–∏—Ü—ã */

      --blue: #3b82f6;
      /* –∞–∫—Ü–µ–Ω—Ç */
      --ok: #22c55e;
      --err: #f87171;
      --info: #38bdf8;

      --shadow: 0 14px 34px rgba(0, 0, 0, 0.40);
      --shadow-soft: 0 10px 22px rgba(0, 0, 0, 0.28);
      --ring: 0 0 0 4px rgba(59, 130, 246, 0.22);
    }


    * {
      box-sizing: border-box
    }

    body {
      font-family: Inter, system-ui, Segoe UI, Roboto, Arial;
      margin: 18px;
      background: var(--bg);
      color: var(--ink);
    }

    /* Layout shell */
    .shell {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .card {
      padding: 16px;
      border-radius: 12px;
      background: var(--card);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(203, 213, 225, 0.9);
    }

    .card.soft {
      background: var(--soft);
      border: 1px solid rgba(203, 213, 225, 0.95);
      box-shadow: none;
    }

    h1 {
      font-size: 18px;
      margin: 0 0 8px;
      line-height: 1.25;
    }

    h2 {
      font-size: 15px;
      margin: 0 0 8px;
      line-height: 1.25;
    }

    h1,
    h2 {
      color: var(--ink);
    }

    h3 {
      font-size: 13px;
      margin: 0 0 8px;
      line-height: 1.25;
      color: var(--ink);
      opacity: .9;
    }

    .small {
      font-size: 12px;
      color: var(--muted);
    }

    .small-muted {
      font-size: 12px;
      color: var(--muted);
    }

    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    /* Sticky top bar */
    .topbar {
      position: sticky;
      top: 10px;
      z-index: 20;
      padding: 10px 12px;
      border-radius: 12px;
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;

      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(203, 213, 225, 0.95);
      box-shadow: var(--shadow);
    }

    .topbar-left {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      min-width: 0;
    }

    .topbar-right {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .pill {
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--soft);
      /* darker chip */
      font-weight: 800;
      font-size: 12px;
      display: inline-flex;
      gap: 6px;
      align-items: center;
      border: 1px solid rgba(203, 213, 225, 0.95);
      color: var(--ink);
    }

    .pill.ok {
      background: rgba(21, 128, 61, 0.14);
      border-color: rgba(21, 128, 61, 0.24);
      color: var(--ok);
    }

    .pill.err {
      background: rgba(220, 38, 38, 0.14);
      border-color: rgba(220, 38, 38, 0.24);
      color: var(--err);
    }

    .pill.info {
      background: rgba(2, 132, 199, 0.14);
      border-color: rgba(2, 132, 199, 0.24);
      color: var(--info);
    }

    .badge {
      font-weight: 900;
    }

    .spacer {
      flex: 1;
      min-width: 10px;
    }

    /* Stepper */
    .steps {
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 8px;
      margin-top: 8px;
    }

    .step {
      padding: 10px;
      border-radius: 10px;
      background: var(--card);
      border: 1px solid rgba(203, 213, 225, 0.95);
      display: flex;
      gap: 10px;
      align-items: center;
      min-width: 0;
      box-shadow: 0 4px 10px rgba(2, 6, 23, 0.05);
    }

    .step .n {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: rgba(29, 78, 216, 0.14);
      color: #1d4ed8;
      font-weight: 900;
      display: grid;
      place-items: center;
      flex: 0 0 auto;
      border: 1px solid rgba(29, 78, 216, 0.26);
      font-size: 12px;
    }

    .step .t {
      font-size: 12px;
      font-weight: 900;
      color: var(--ink);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    @media (max-width: 1100px) {
      .steps {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    @media (max-width: 680px) {
      .steps {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    /* Forms */
    label {
      display: block;
      font-size: 13px;
      color: var(--ink);
      margin-top: 8px;
      font-weight: 700;
      margin-top: 0px;
    }

    input[type=text],
    select,
    textarea {
      width: 100%;
      padding: 9px 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      /* darker than #e6e9ef */
      border-radius: 10px;
      font-size: 14px;
      outline: none;
      background: var(--card);
      color: var(--ink);
    }

    input[type=text]:focus,
    select:focus,
    textarea:focus {
      border-color: rgba(29, 78, 216, 0.65);
      box-shadow: var(--ring);
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    input[type=file] {
      margin-top: 8px;
    }

    .highlight-select {
      border: 2px solid rgba(29, 78, 216, 0.65);
      background: rgba(29, 78, 216, 0.08);
      padding: 7px 8px;
      border-radius: 10px;
      transition: 0.25s ease;
      font-weight: 900;
    }

    .row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
      align-items: start;
    }

    .row.two {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .row.one {
      grid-template-columns: 1fr;
    }

    @media (max-width: 1024px) {

      .row,
      .row.two {
        grid-template-columns: 1fr;
      }
    }

    /* Buttons */
    button {
      background: var(--blue);
      color: var(--card);
      border: 0;
      padding: 9px 12px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 900;
      font-size: 13px;
      box-shadow: 0 6px 14px rgba(29, 78, 216, 0.18);
    }

    button:hover {
      filter: brightness(0.98);
    }

    button.secondary {
      background: #dbe3ee;
      color: #0b1220;
      box-shadow: 0 6px 14px rgba(2, 6, 23, 0.06);
    }

    button.warn {
      background: var(--err);
      color: var(--card);
      box-shadow: 0 6px 14px rgba(220, 38, 38, 0.16);
    }

    button:disabled {
      opacity: .6;
      cursor: not-allowed;
      box-shadow: none;
    }

    .controls {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .controls.split {
      justify-content: space-between;
    }

    .btn-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* Sections / Accordions */
    details.accordion {
      border: 1px solid rgba(203, 213, 225, 0.95);
      border-radius: 12px;
      background: var(--card);
      overflow: hidden;
    }

    details.accordion[open] {
      box-shadow: var(--shadow-soft);
    }

    details.accordion summary {
      list-style: none;
      cursor: pointer;
      padding: 12px 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      user-select: none;
      background: var(--card);
    }

    details.accordion summary::-webkit-details-marker {
      display: none;
    }

    .summary-title {
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 0;
    }

    .summary-title .k {
      font-weight: 900;
      font-size: 13px;
      white-space: nowrap;
      color: var(--ink);
    }

    .summary-title .d {
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .chev {
      width: 28px;
      height: 28px;
      border-radius: 10px;
      display: grid;
      place-items: center;
      background: var(--soft);
      border: 1px solid rgba(203, 213, 225, 0.95);
      flex: 0 0 auto;
      font-weight: 900;
      color: var(--ink);
    }

    details[open] .chev {
      transform: rotate(90deg);
    }

    .accordion-body {
      padding: 12px 14px 14px;
      border-top: 1px solid rgba(203, 213, 225, 0.95);
      background: var(--soft);
    }

    /* Parser result cards */
    .results-layout {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    @media (max-width: 1024px) {
      .results-layout {
        grid-template-columns: 1fr;
      }
    }

    .result-column {
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-width: 0;
    }

    .result-card {
      background: var(--card);
      border: 1px solid rgba(203, 213, 225, 0.95);
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      position: relative;
      transition: transform .08s ease, box-shadow .08s ease;
    }

    .result-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 22px rgba(2, 6, 23, 0.08);
    }

    .result-title {
      font-size: 12px;
      font-weight: 900;
      color: var(--ink);
      opacity: .9;
    }

    .result-number {
      font-family: ui-monospace, monospace;
      font-size: 13px;
      word-break: break-all;
      margin-top: 6px;
      color: var(--ink);
    }

    .count-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--ok);
      color: var(--card);
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 11px;
      font-weight: 900;
      box-shadow: 0 8px 16px rgba(21, 128, 61, 0.18);
    }

    .result-card.main {
      border-left: 4px solid var(--ok);
    }

    .result-card.sql {
      border-left: 4px solid var(--info);
    }

    .result-card.num-csv {
      border-left: 4px solid var(--blue);
    }

    .result-card.uuid-main {
      border-left: 4px solid #6d28d9;
    }

    .result-card.uuid-sql {
      border-left: 4px solid #be185d;
    }

    .result-card.uuid-csv {
      border-left: 4px solid #ea580c;
    }

    .result-card.grz-main {
      border-left: 4px solid var(--err);
    }

    .result-card.grz-sql {
      border-left: 4px solid #b91c1c;
    }

    .result-card.grz-csv {
      border-left: 4px solid #991b1b;
    }

    .status {
      margin-top: 10px;
      padding: 10px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 900;
      border: 1px solid rgba(203, 213, 225, 0.95);
    }

    .status.success {
      background: rgba(21, 128, 61, .10);
      color: var(--ok);
      border-color: rgba(21, 128, 61, .22);
    }

    .status.error {
      background: rgba(220, 38, 38, .10);
      color: var(--err);
      border-color: rgba(220, 38, 38, .22);
    }

    .debug {
      margin-top: 8px;
      border-radius: 10px;
      padding: 10px;
      background: #0b1220;
      color: #e6eef9;
      font-family: ui-monospace, monospace;
      font-size: 12px;
      border: 1px solid rgba(203, 213, 225, 0.18);
    }

    .query-button {
      background: var(--blue);
      color: var(--card);
      border: 0;
      padding: 9px 12px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 900;
      margin-top: 4px;
    }

    .db-results-container {
      margin-top: 10px;
      padding: 10px;
      background: var(--card);
      border: 1px solid rgba(203, 213, 225, 0.95);
      border-radius: 10px;
    }

    .db-results-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    .db-results-table th,
    .db-results-table td {
      border: 1px solid rgba(203, 213, 225, 0.95);
      padding: 6px;
      text-align: left;
    }

    .db-results-table th {
      background: rgba(148, 163, 184, 0.12);
    }

    /* Logging (KEEP AS-IS) */
    #previewBox,
    #logBox {
      margin-top: 12px;
      border-radius: 8px;
      padding: 10px;
      background: #0b1220;
      color: #e6eef9;
      max-height: 260px;
      overflow: auto;
    }

    .line {
      padding: 6px;
      border-radius: 6px;
      margin-bottom: 6px;
      font-family: monospace;
      white-space: pre-wrap;
    }

    .line.ok {
      background: rgba(21, 128, 61, 0.10);
      color: var(--ok);
      border: 1px solid rgba(21, 128, 61, 0.16);
    }

    .line.err {
      background: rgba(220, 38, 38, 0.10);
      color: var(--err);
      border: 1px solid rgba(220, 38, 38, 0.16);
    }

    .line.info {
      background: rgba(2, 132, 199, 0.10);
      color: var(--info);
      border: 1px solid rgba(2, 132, 199, 0.16);
    }

    /* Options list */
    .optlist {
      display: flex;
      gap: 8px;
      flex-direction: column;
      padding: 10px 12px;
      border: 1px dashed rgba(100, 116, 139, .55);
      border-radius: 12px;
      background: color-mix(in srgb, var(--card) 92%, transparent);
    }

    .optlist label {
      margin-top: 0;
      font-weight: 650;
      color: var(--ink);
    }

    .footer {
      margin-top: 12px;
      font-size: 13px;
      color: var(--muted);
    }

    /* Operation fields visibility */
    .op-fields {
      display: none;
    }

    .op-fields.active {
      display: block;
    }

    /* Quick anchors */
    .anchor {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      font-size: 12px;
      font-weight: 900;
      color: var(--blue);
      text-decoration: none;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid color-mix(in srgb, var(--blue) 35%, transparent);
      background: color-mix(in srgb, var(--blue) 14%, transparent);
    }

    .anchor:hover {
      background: color-mix(in srgb, var(--blue) 20%, transparent);
    }

    /* –≥—Ä–∞–Ω–∏—Ü—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ–º */
    .card,
    .step,
    .result-card,
    details.accordion,
    .db-results-container,
    .db-results-table th,
    .db-results-table td {
      border-color: var(--border);
    }

    /* –∏–Ω–ø—É—Ç—ã/—Å–µ–ª–µ–∫—Ç—ã/textarea ‚Äî —á—Ç–æ–±—ã –≤ dark –Ω–µ –±—ã–ª–∏ –±–µ–ª—ã–º–∏ */
    input[type=text],
    select,
    textarea {
      background: var(--card);
      color: var(--ink);
      border-color: rgba(148, 163, 184, 0.35);
    }

    input[type=text]::placeholder,
    textarea::placeholder {
      color: rgba(148, 163, 184, 0.85);
    }

    /* topbar —Ñ–æ–Ω —Ç–æ–∂–µ –æ—Ç —Ç–µ–º—ã */
    .topbar {
      background: color-mix(in srgb, var(--card) 88%, transparent);
      border-color: color-mix(in srgb, var(--border) 85%, transparent);
    }

    button.secondary {
      background: color-mix(in srgb, var(--card) 70%, var(--muted) 10%);
      color: var(--ink);
      border: 1px solid color-mix(in srgb, var(--border) 80%, transparent);
      box-shadow: 0 6px 14px rgba(2, 6, 23, 0.06);
    }
  </style>

</head>

<body>
  <div class="shell">

    <!-- Sticky top bar -->
    <div class="topbar">
      <div class="topbar-left">
        <span class="pill info">Mode: <span id="modePill" class="badge">pay_type</span></span>
        <span class="pill">–í—Å–µ–≥–æ: <span id="total" class="badge">0</span></span>
        <span class="pill ok">–£—Å–ø–µ—Ö: <span id="success" class="badge">0</span></span>
        <span class="pill err">–û—à–∏–±–∫–∏: <span id="fail" class="badge">0</span></span>
        <span class="pill">–ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="progress" class="badge">0/0</span></span>
      </div>
      <div class="topbar-right">
        <button id="themeToggle" type="button" class="secondary" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô –¢–µ–º–∞</button>
        <label style="display:flex;align-items:center;gap:8px;font-size:12px;font-weight:800;color:var(--muted)">
          –†–µ–∂–∏–º
          <select id="modeSidebar" class="highlight-select" style="min-width:180px;height:34px;padding:4px 10px;">
            <option value="pay_type">–¢–∏–ø –æ–ø–ª–∞—Ç—ã</option>
            <option value="class_change">–ö–ª–∞—Å—Å</option>
            <option value="grn_comment">–ì–†–ù–ó+–∫–æ–º–º–µ–Ω—Ç</option>
            <option value="pan_change">PAN-–ü–∞—Ä—Å–∏–Ω–≥</option>
          </select>
        </label>
        <a class="anchor" href="#sendSection">‚§µÔ∏è –ö –æ—Ç–ø—Ä–∞–≤–∫–µ</a>
        <a class="anchor" href="#logsSection">‚§µÔ∏è –ö –ª–æ–≥–∞–º</a>
      </div>
    </div>

    <!-- Main header -->
    <div class="card">
      <h1>Bulk Sender Ultimate v6.2 ‚Äî set_pay_type / grn+comment / pan-–ø–æ–∂–∏—Ä–∞—Ç–µ–ª—å / –∏–ª–∏ –≤–µ–ª–æ—Å–∏–ø–µ–¥ –∫–æ—Ç–æ—Ä—ã–π —Å–≤–∞—Ä–∏–ª–∏ –≤
        –≥–∞—Ä–∞–∂–µ –∏–∑ —á–µ–≥–æ –ø–æ–ø–∞–ª–æ, –∞ –æ–Ω –≤–∑—è–ª –∏ –ø–æ–µ—Ö–∞–ª</h1>
      <div class="small-muted">
        CSV –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å UUID (–≤ –ª—é–±–æ–º —Å—Ç–æ–ª–±—Ü–µ) –∏–ª–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ UUID –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ ‚Äî
        –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
        –ø–æ–ø—Ä–æ–±—É–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å.
      </div>

      <div class="steps" style="margin-top:12px">
        <div class="step"><span class="n">1</span><span class="t">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></div>
        <div class="step"><span class="n">2</span><span class="t">–¢–∏–∫–µ—Ç / –¢–µ–∫—Å—Ç</span></div>
        <div class="step"><span class="n">3</span><span class="t">–ü–∞—Ä—Å–µ—Ä</span></div>
        <div class="step"><span class="n">4</span><span class="t">–û–ø–µ—Ä–∞—Ü–∏—è</span></div>
        <div class="step"><span class="n">5</span><span class="t">–ò–º–ø–æ—Ä—Ç UUID</span></div>
        <div class="step"><span class="n">6</span><span class="t">–û—Ç–ø—Ä–∞–≤–∫–∞</span></div>
        <div class="step"><span class="n">7</span><span class="t">–ë–î / –ü–µ—Ä–∏–æ–¥—ã</span></div>
      </div>
    </div>

    <!-- 1) Global settings -->
    <details class="accordion" open id="settingsSection">
      <summary>
        <div class="summary-title">
          <span class="k">‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span>
          <span class="d">API + –∑–∞–¥–µ—Ä–∂–∫–∏ + –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–≤–≤–æ–¥–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑)</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="card soft" style="margin-bottom:12px">
          <h2>API</h2>
          <div class="row">
            <div>
              <label>Request URL</label>
              <input id="url" type="text" value="http://10.2.201.200/api/ui/find-transactions/set_pay_type" />
              <div class="hint">–û–±—ã—á–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ ‚Äî –Ω–∞—Å—Ç—Ä–æ–π –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Ä–∞–±–æ—Ç–∞–π.</div>
            </div>

            <div>
              <label>HTTP method</label>
              <select id="method">
                <option>POST</option>
                <option>PUT</option>
                <option>PATCH</option>
              </select>
            </div>

            <div>
              <label>Authorization (Bearer ...)</label>
              <input id="auth" type="text" placeholder="Bearer ..." />
            </div>
          </div>

          <div class="row two" style="margin-top:6px">
            <div>
              <label>Delay –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (ms)</label>
              <input id="delay" type="text" value="200" />
              <div class="hint">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: 200‚Äì500 –º—Å, –µ—Å–ª–∏ API –Ω–∞—á–∏–Ω–∞–µ—Ç ‚Äú–ø–æ–¥–ø–ª–∞–≤–ª—è—Ç—å—Å—è‚Äù.</div>
            </div>
            <div>
              <label style="opacity:.9">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
              <div class="small">
                –¢—É—Ç –º–æ–∂–Ω–æ –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏—Ç—å timeout/retry/limit, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è. –°–µ–π—á–∞—Å –æ—Å—Ç–∞–≤–∏–ª –º–∏–Ω–∏–º–∞–ª—å–Ω–æ.
              </div>
            </div>
          </div>
        </div>

        <div class="card soft">
          <h2>GLPI</h2>
          <div class="row">
            <div>
              <label>GLPI Cookie (x-glpi-cookie)</label>
              <input id="glpiCookie" type="text" placeholder="PHPSESSID=...; glpi...=...">
              <label>GLPI App-Token</label>
              <input id="glpiAppToken" type="text" placeholder="App-Token ...">
              <label>GLPI User token</label>
              <input id="glpiUserToken" type="text" placeholder="User token ...">
              <div class="hint">Cookie –±–µ—Ä—ë–º –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (DevTools ‚Üí Application/Storage ‚Üí Cookies ‚Üí
                techsupport.megatoll.ru)</div>
            </div>
            <div>
              <label>Ticket base</label>
              <input id="ticketBase" type="text" value="https://techsupport.megatoll.ru/front/ticket.form.php?id=" />
              <div class="hint">–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç–∞ —Ç–∏–∫–µ—Ç–∞.</div>
            </div>
            <div>
              <label style="opacity:.9">–°–ø—Ä–∞–≤–∫–∞</label>
              <div class="small">
                –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –≤ GLPI (–±—ã—Ç—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–º –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ). Cookie –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –≤–≤–µ—Ä—Ö—É –∏ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å.
              </div>
            </div>
          </div>
        </div>
      </div>
    </details>

    <!-- 2) Ticket/text source -->
    <details class="accordion" open id="ticketTextSection">
      <summary>
        <div class="summary-title">
          <span class="k">üì• –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–∫—Å—Ç–∞</span>
          <span class="d">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–∞ –∏–ª–∏ –≤—Å—Ç–∞–≤–∫–∞ —Å—ã—Ä–æ–≥–æ —Ç–µ–∫—Å—Ç–∞</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="row">
          <div class="card soft">
            <h2>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–∞</h2>
            <label>Ticket ID</label>
            <input id="ticketId" type="text" placeholder="11353" />
            <div class="controls">
              <button id="btnLoadTicket" type="button" class="secondary">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç —Ç–∏–∫–µ—Ç–∞</button>
              <span class="small">–ë–µ—Ä—ë—Ç cookie –∏–∑ ‚Äú–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí GLPI‚Äù.</span>
            </div>
          </div>

          <div class="card soft" style="grid-column: span 2;">
            <h2>üìù –¢–µ–∫—Å—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞</h2>
            <textarea id="inputText" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç..."></textarea>
            <div class="controls split">
              <div class="btn-group">
                <button id="btnTransferText" type="button" class="secondary">‚û°Ô∏è –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –≤ Sender
                  textarea</button>
              </div>
              <div class="small-muted">–ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –ª—é–±—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã ‚Äî –ø–∞—Ä—Å–µ—Ä –ø–æ–ø—Ä–æ–±—É–µ—Ç –≤—ã—Ç–∞—â–∏—Ç—å
                UUID/–ì–†–ù–ó/–ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.
              </div>
            </div>
          </div>
        </div>
      </div>
    </details>

    <!-- 3) Parser -->
    <details class="accordion" open id="parserSection">
      <summary>
        <div class="summary-title">
          <span class="k">üîç –ü–∞—Ä—Å–µ—Ä</span>
          <span class="d">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è / UUID / –ì–†–ù–ó) + –¥–µ–π—Å—Ç–≤–∏—è</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <!-- Keep original #result container + internal ids, only moved here -->
        <div id="result" style="display:none;">
          <div class="results-layout">
            <div class="result-column">
              <h3 style="color:#16a34a;">üìú –ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</h3>
              <div class="result-card main" id="cardNumMain" onclick="copyNumber()">
                <div class="count-badge" id="mainCount">0</div>
                <div class="result-title">üì± –ù–æ–º–µ—Ä –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</div>
                <div class="result-number" id="outputText"></div>
              </div>
              <div class="result-card sql" id="cardNumSql" onclick="copySQL()">
                <div class="count-badge" id="sqlCount">0</div>
                <div class="result-title">üíæ SQL IN (...)</div>
                <div class="result-number" id="sqlOutput"></div>
              </div>
              <div class="result-card num-csv" id="cardNumCsv" onclick="copyNumCsv()">
                <div class="count-badge" id="numCsvCount">0</div>
                <div class="result-title">üìÑ CSV</div>
                <div class="result-number" id="numCsvOutput"></div>
              </div>
              <button id="queryDbBtn" class="query-button" style="display:none;">üì° –ù–∞–π—Ç–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –ë–î</button>
            </div>

            <div class="result-column">
              <h3 style="color:#7c3aed;">üÜî UUID</h3>
              <div class="result-card uuid-main" id="cardUuidMain" onclick="copyUUIDMain()">
                <div class="count-badge" id="uuidMainCount">0</div>
                <div class="result-title">üÜî UUID (–≥–ª–∞–≤–Ω—ã–π)</div>
                <div class="result-number" id="uuidOutput"></div>
              </div>
              <div class="controls">
                <button id="btnUseParsedUuids" class="secondary" type="button">‚û°Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UUID –≤ Sender</button>
                <button id="btnFillGrnMode" class="secondary" type="button">‚öôÔ∏è –ü–æ–¥—Å—Ç–∞–≤–∏—Ç—å UUID + –ì–†–ù–ó –≤
                  grn+comment</button>
              </div>
            </div>

            <div class="result-column">
              <h3 style="color:#ef4444;">üöó –ì–†–ù–ó</h3>
              <div class="result-card grz-main" id="cardGrzMain" onclick="copyGrzMain()">
                <div class="count-badge" id="grzMainCount">0</div>
                <div class="result-title">üöó –ì–†–ù–ó (–≥–ª–∞–≤–Ω—ã–π)</div>
                <div class="result-number" id="grzOutput"></div>
              </div>
              <div class="result-card grz-sql" id="cardGrzSql" onclick="copyGrzSQL()">
                <div class="count-badge" id="grzSqlCount">0</div>
                <div class="result-title">üíæ SQL IN (–ì–†–ù–ó)</div>
                <div class="result-number" id="grzSqlOutput"></div>
              </div>
              <div class="result-card grz-csv" id="cardGrzCsv" onclick="copyGrzCsv()">
                <div class="count-badge" id="grzCsvCount">0</div>
                <div class="result-title">üìÑ CSV –ì–†–ù–ó</div>
                <div class="result-number" id="grzCsvOutput"></div>
              </div>
            </div>
          </div>

          <div id="status" class="status"></div>
          <div id="debug" class="debug"></div>

          <div id="dbResultsContainer" class="db-results-container" style="display:none;">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –ë–î</h3>
            <div id="dbResultsOutput"></div>
          </div>
        </div>

        <div class="small-muted">
          –ï—Å–ª–∏ –±–ª–æ–∫ –ø–∞—Ä—Å–µ—Ä–∞ –ø—É—Å—Ç ‚Äî –≤—Å—Ç–∞–≤—å —Ç–µ–∫—Å—Ç –≤ ‚Äú–ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–∫—Å—Ç–∞‚Äù –∏ –∑–∞–ø—É—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä (JS –º–æ–¥—É–ª—å —Å–¥–µ–ª–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–µ).
        </div>
      </div>
    </details>

    <!-- 4) Operation -->
    <details class="accordion" open id="operationSection">
      <summary>
        <div class="summary-title">
          <span class="k">üß© –û–ø–µ—Ä–∞—Ü–∏—è</span>
          <span class="d">–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ + –ø–æ–ª—è —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="row">
          <div class="card soft">
            <h2>Operation mode</h2>
            <label>–†–µ–∂–∏–º</label>
            <select id="mode" class="highlight-select">
              <option value="pay_type">–°–º–µ–Ω–∏—Ç—å pay_type (body: { transaction_uuid, pay_type })</option>
              <option value="class_change">–°–º–µ–Ω–∏—Ç—å class (body: { transaction_uuid, class })</option>
              <option value="grn_comment">–û—Ç–ø—Ä–∞–≤–∏—Ç—å grn + comment (body: { transaction_uuid, grn, comment })</option>
              <option value="pan_change">–°–º–µ–Ω–∏—Ç—å PAN (–ø–∞—Ä—Å–∏–Ω–≥ –∏–∑ —Ç–µ–∫—Å—Ç–∞) (body: { transaction_uuid, grn, comment })
              </option>
            </select>
            <div class="hint">–ù–∏–∂–µ –ø–æ—è–≤—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ä–µ–∂–∏–º—É.</div>
          </div>

          <div class="card soft" style="grid-column: span 2;">
            <h2>–ü–æ–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>

            <!-- pay_type fields -->
            <div id="fields_pay_type" class="op-fields">
              <div class="row two">
                <div>
                  <label>Pay type</label>
                  <input id="payType" type="text" value="5" />
                  <div class="hint">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Å–º–µ–Ω—ã pay_type.</div>
                </div>
                <div>
                  <label style="opacity:.9">–°–ø—Ä–∞–≤–∫–∞</label>
                  <div class="small">–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: <b>{ transaction_uuid, pay_type }</b></div>
                </div>
              </div>
            </div>

            <!-- class_change fields -->
            <div id="fields_class_change" class="op-fields">
              <div class="row two">
                <div>
                  <label>Class</label>
                  <select id="classValue">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4" selected>4</option>
                  </select>
                  <div class="hint">–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∫–ª–∞—Å—Å—ã: 1, 2, 3, 4.</div>
                </div>
                <div>
                  <label style="opacity:.9">–°–ø—Ä–∞–≤–∫–∞</label>
                  <div class="small">–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: <b>{ transaction_uuid, class }</b></div>
                  <div class="small">API: <b>/api/ui/find-transactions/set_class</b></div>
                </div>
              </div>

            </div>

            <!-- grn_comment fields -->
            <div id="fields_grn_comment" class="op-fields">
              <div class="row">
                <div>
                  <label>GRN</label>
                  <input id="grn" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä T732YE797" />
                </div>
                <div>
                  <label>COMMENT</label>
                  <input id="comment" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 8667" />
                </div>
                <div>
                  <label style="opacity:.9">–°–ø—Ä–∞–≤–∫–∞</label>
                  <div class="small">–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: <b>{ transaction_uuid, grn, comment }</b></div>
                </div>
              </div>
            </div>

            <!-- pan_change fields -->
            <div id="fields_pan_change" class="op-fields">
              <div class="row one">
                <div>
                  <div class="small-muted">
                    –†–µ–∂–∏–º PAN: –ø–∞—Ä—Å–∏–Ω–≥ –∏–¥—ë—Ç –∏–∑ —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤—è–∑–∫–∞ <b>transaction_uuid + grn +
                      comment</b> (–∫–∞–∫ –≤ grn_comment).
                    <br />–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è PAN ‚Äî –¥–æ–±–∞–≤—å —Å—é–¥–∞, –∏ –≤ JS —Å—Ñ–æ—Ä–º–∏—Ä—É–π body.
                  </div>
                </div>
              </div>

              <!-- –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ –∂–µ –ø–æ–ª—è grn/comment (–æ–Ω–∏ –Ω—É–∂–Ω—ã –∏ –¥–ª—è pan_change –ø–æ —Ç–≤–æ–µ–º—É –æ–ø–∏—Å–∞–Ω–∏—é) -->
              <div class="row">
                <div>
                  <label>GRN</label>
                  <input id="grn_pan_mirror" type="text"
                    placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä T732YE797 (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –±–µ—Ä—ë—à—å –∏–∑ –ø–∞—Ä—Å–µ—Ä–∞)" />
                  <div class="hint">–≠—Ç–æ –∑–µ—Ä–∫–∞–ª–æ, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º id. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —É–±–µ—Ä–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–π
                    #grn/#comment.</div>
                </div>
                <div>
                  <label>COMMENT</label>
                  <input id="comment_pan_mirror" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 8667" />
                </div>
                <div>
                  <label style="opacity:.9">–°–ø—Ä–∞–≤–∫–∞</label>
                  <div class="small">–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–∫–∞–∫ —Å–µ–π—á–∞—Å): <b>{ transaction_uuid, grn, comment }</b></div>
                </div>
              </div>
            </div>

            <div class="hint">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ç–µ–∫—É—â–∏–º JS, –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å —Ç–µ–º–∏ –∂–µ id (#payType,
              #grn, #comment).</div>
          </div>
        </div>
      </div>
    </details>

    <!-- 5) Import UUID -->
    <details class="accordion" open id="importSection">
      <summary>
        <div class="summary-title">
          <span class="k">üìÑ –ò–º–ø–æ—Ä—Ç UUID</span>
          <span class="d">–§–∞–π–ª / textarea + –ø—Ä–∞–≤–∏–ª–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="row">
          <div class="card soft">
            <h2>–ò—Å—Ç–æ—á–Ω–∏–∫ UUID</h2>
            <label>–ò—Å—Ç–æ—á–Ω–∏–∫</label>
            <select id="source" class="highlight-select">
              <option value="file">CSV / TXT —Ñ–∞–π–ª</option>
              <option value="textarea">–ü–æ–ª–µ –≤–≤–æ–¥–∞ (textarea)</option>
            </select>

            <label style="margin-top:10px">CSV / TXT —Ñ–∞–π–ª</label>
            <input id="csvFile" type="file" accept=".csv,.txt" />
            <div class="hint">–ú–æ–∂–Ω–æ —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ UUID –≤ —Å—Ç—Ä–æ–∫–∞—Ö.</div>
          </div>

          <div class="card soft">
            <h2>–†—É—á–Ω–æ–π –≤–≤–æ–¥ UUID / CSV</h2>
            <label>Textarea</label>
            <textarea id="textArea" placeholder="uuid1\nuuid2\n–∏–ª–∏ transaction_uuid,grn,..."></textarea>
            <div class="hint">–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏: –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫–∏, –∑–∞–ø—è—Ç–∞—è, ;, –ø—Ä–æ–±–µ–ª—ã, —Ç–∞–±—ã. Header —Ç–æ–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.</div>
          </div>

          <div class="card soft">
            <h2>–û–ø—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∞</h2>

            <label>UUID column name (–µ—Å–ª–∏ –≤ CSV header)</label>
            <input id="uuidCol" type="text" placeholder="transaction_uuid (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" />
            <div class="hint">–ï—Å–ª–∏ CSV –∏–º–µ–µ—Ç header ‚Äî —É–∫–∞–∂–∏ –∏–º—è —Å—Ç–æ–ª–±—Ü–∞; –∏–Ω–∞—á–µ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ UUID
              –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
            </div>

            <div class="optlist" style="margin-top:10px">
              <label><input id="fastExtract" type="checkbox" checked /> –ë—ã—Å—Ç—Ä–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ UUID –∏–∑ –ª—é–±–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
                (–Ω–∞–ø—Ä–∏–º–µ—Ä
                smena-pan.txt)</label>
              <label><input id="useFirstColIfHeader" type="checkbox" checked /> –ï—Å–ª–∏ header –Ω–µ —É–∫–∞–∑–∞–Ω ‚Äî –±—Ä–∞—Ç—å –ø–µ—Ä–≤—É—é
                –∫–æ–ª–æ–Ω–∫—É</label>
              <label><input id="skipPreview" type="checkbox" /> –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å Preview –ø–µ—Ä–µ–¥ Send All (–Ω–µ
                —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)</label>
              <label><input id="autoDownloadErrors" type="checkbox" /> –°–∫–∞—á–∞—Ç—å errors.csv –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</label>
              <label><input id="autoClosePeriods" type="checkbox" /> –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π
                –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
            </div>
          </div>
        </div>
      </div>
    </details>

    <!-- 6) Sending -->
    <details class="accordion" open id="sendSection">
      <summary>
        <div class="summary-title">
          <span class="k">üöÄ –û—Ç–ø—Ä–∞–≤–∫–∞</span>
          <span class="d">Preview ‚Üí Send 1 ‚Üí Send All + –æ—Ç—á—ë—Ç—ã</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="card soft">
          <div class="controls split">
            <div class="btn-group">
              <button id="btnPreview">Preview (–ø–µ—Ä–≤—ã–µ 10)</button>
              <button id="btnSendOne" class="secondary">Send 1 (—Ç–µ—Å—Ç)</button>
            </div>

            <div class="btn-group">
              <button id="btnSendAll">Send All</button>
              <button id="btnPause" class="secondary" disabled>Pause</button>
              <button id="btnStop" class="warn" disabled>Stop</button>
            </div>

            <div class="btn-group">
              <button id="btnDownloadErrors" class="secondary">–°–∫–∞—á–∞—Ç—å errors.csv</button>
              <button id="btnDownloadReport" class="secondary">–°–∫–∞—á–∞—Ç—å report.csv</button>
            </div>
          </div>

          <div class="small-muted" style="margin-top:10px">
            –°–æ–≤–µ—Ç: Preview ‚Üí Send 1 ‚Üí Send All
          </div>

          <h3 style="margin-top:14px">PREVIEW</h3>
          <div id="previewBox"></div>

          <div class="footer">
            <div class="hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤ textarea: –ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ UUID, CSV —Å header, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏:
              –∑–∞–ø—è—Ç–∞—è,
              ;, –ø—Ä–æ–±–µ–ª—ã, —Ç–∞–±—ã, –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫–∏.</div>
          </div>
        </div>
      </div>
    </details>

    <!-- 7) DB & periods -->
    <details class="accordion" open id="dbSection">
      <summary>
        <div class="summary-title">
          <span class="k">üóÑÔ∏è –ë–î / –ü–µ—Ä–∏–æ–¥—ã</span>
          <span class="d">–ü–æ–∏—Å–∫/—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ SQL –æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –ø–µ—Ä–∏–æ–¥—ã</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <div class="row two">
          <div class="card soft">
            <h2>–ü–µ—Ä–∏–æ–¥—ã</h2>
            <div class="controls">
              <button id="btnOpenPeriods" class="secondary">–û—Ç–∫—Ä—ã—Ç—å –ø–µ—Ä–∏–æ–¥—ã (SQL)</button>
              <button id="btnClosePeriods" class="secondary">–ó–∞–∫—Ä—ã—Ç—å –ø–µ—Ä–∏–æ–¥—ã (SQL)</button>
            </div>
            <div class="hint">–û–±—ã—á–Ω–æ —ç—Ç–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã ‚Äî –¥–µ—Ä–∂–∏–º —Ä—è–¥–æ–º —Å –ë–î.</div>
          </div>

          <div class="card soft">
            <h2>–ü–æ–∏—Å–∫ –≤ –ë–î</h2>
            <div class="small-muted">
              –ö–Ω–æ–ø–∫–∞ ‚Äúüì° –ù–∞–π—Ç–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –ë–î‚Äù –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä—Å–µ—Ä–æ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (id —Å–æ—Ö—Ä–∞–Ω—ë–Ω: #queryDbBtn).
            </div>
            <div class="hint">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –±–ª–æ–∫–µ –ø–∞—Ä—Å–µ—Ä–∞ (—Ç–∞–±–ª–∏—Ü–∞) ‚Äî id —Å–æ—Ö—Ä–∞–Ω—ë–Ω.</div>
          </div>
        </div>
      </div>
    </details>

    <!-- 8) Logs (UNCHANGED) -->
    <details class="accordion" open id="logsSection">
      <summary>
        <div class="summary-title">
          <span class="k">üßæ –õ–æ–≥–∏</span>
          <span class="d">–û—Å—Ç–∞–≤–ª–µ–Ω–æ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π</span>
        </div>
        <span class="chev">‚Ä∫</span>
      </summary>

      <div class="accordion-body">
        <h3>–õ–æ–≥–∏</h3>
        <div id="logBox"></div>
      </div>
    </details>

  </div>

  <!-- Small helper: show/hide operation fields based on #mode -->
  <script>
    (function () {
      const mode = document.getElementById('mode');
      const modeSidebar = document.getElementById('modeSidebar');
      const pill = document.getElementById('modePill');

      const blocks = {
        pay_type: document.getElementById('fields_pay_type'),
        class_change: document.getElementById('fields_class_change'),
        grn_comment: document.getElementById('fields_grn_comment'),
        pan_change: document.getElementById('fields_pan_change')
      };

      function applyMode(source) {
        const v = source?.value || mode?.value || modeSidebar?.value || 'pay_type';
        if (mode && mode.value !== v) mode.value = v;
        if (modeSidebar && modeSidebar.value !== v) modeSidebar.value = v;
        if (pill) pill.textContent = v;
        Object.keys(blocks).forEach(k => {
          if (!blocks[k]) return;
          blocks[k].classList.toggle('active', k === v);
        });
      }

      if (mode) {
        mode.addEventListener('change', () => applyMode(mode));
      }

      if (modeSidebar) {
        modeSidebar.addEventListener('change', () => applyMode(modeSidebar));
      }

      applyMode(mode);
    })();
  </script>

  <!-- Your existing modules -->
  <script src="js-bs-6/tema.js"></script>
  <script type="module" src="js-bs-6/main.js"></script>
  <script type="module" src="js-bs-6/parser/main.js"></script>
  <script type="module" src="js-bs-6/ticket_parser.js"></script>

</body>

</html>